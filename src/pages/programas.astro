---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/shared/Navbar.jsx';
import sql from '../lib/db.js';
import { 
  TreePine,
  ThermometerSun,
  Microscope,
  Sprout,
  HeartHandshake,
  Megaphone,
  Landmark,
  Users,
  Globe2,
  MapPin, 
  Target, 
  CheckCircle2, 
  FileText,
  ChevronRight,
  ArrowRight,
  ChevronDown,
  Mail,
  Clock,
  Send
} from 'lucide-react';

interface Programa {
  id: number;
  slug: string;
  titulo: string;
  descripcion: string;
}

let programasDB: Programa[] = [];
try {
  programasDB = await sql`
    SELECT id, slug, titulo, descripcion 
    FROM programas 
    ORDER BY id ASC
  `;
} catch (error) {
  console.error('Error loading programas:', error);
  programasDB = [];
}

interface ConfigVisual {
  color: string;
  border: string;
  bg_icon: string;
  text_icon: string;
  icon: any;
  img: string;
}

const configVisual: Record<number, ConfigVisual> = {
  1: { 
    color: "bg-green-600", 
    border: "border-green-200", 
    bg_icon: "bg-green-50", 
    text_icon: "text-green-600", 
    icon: TreePine, 
    img: "/imags/material_programas/proyect_1.jpg" 
  },
  2: { 
    color: "bg-blue-600", 
    border: "border-blue-200", 
    bg_icon: "bg-blue-50", 
    text_icon: "text-blue-600", 
    icon: ThermometerSun, 
    img: "/imags/material_programas/proyect_2.jpg" 
  },
  3: { 
    color: "bg-indigo-600", 
    border: "border-indigo-200", 
    bg_icon: "bg-indigo-50", 
    text_icon: "text-indigo-600", 
    icon: Microscope, 
    img: "/imags/material_programas/proyect_3.jpg" 
  },
  4: { 
    color: "bg-amber-600", 
    border: "border-amber-200", 
    bg_icon: "bg-amber-50", 
    text_icon: "text-amber-600", 
    icon: Sprout, 
    img: "/imags/material_programas/proyect_4.jpg" 
  },
  5: { 
    color: "bg-rose-600", 
    border: "border-rose-200", 
    bg_icon: "bg-rose-50", 
    text_icon: "text-rose-600", 
    icon: HeartHandshake, 
    img: "/imags/material_programas/proyect_5.jpg" 
  },
  6: { 
    color: "bg-cyan-600", 
    border: "border-cyan-200", 
    bg_icon: "bg-cyan-50", 
    text_icon: "text-cyan-600", 
    icon: Megaphone, 
    img: "/imags/material_programas/proyect_6.jpg" 
  },
  7: { 
    color: "bg-slate-600", 
    border: "border-slate-200", 
    bg_icon: "bg-slate-50", 
    text_icon: "text-slate-600", 
    icon: Landmark, 
    img: "/imags/material_programas/proyect_7.jpg" 
  },
  8: { 
    color: "bg-purple-600", 
    border: "border-purple-200", 
    bg_icon: "bg-purple-50", 
    text_icon: "text-purple-600", 
    icon: Users, 
    img: "/imags/material_programas/proyect_8.jpg" 
  },
  9: { 
    color: "bg-emerald-600", 
    border: "border-emerald-200", 
    bg_icon: "bg-emerald-50", 
    text_icon: "text-emerald-600", 
    icon: Globe2, 
    img: "/imags/material_programas/proyect_9.jpg" 
  }
};

interface ProyectoEjemplo {
  nombre: string;
  estado: string;
  estadoColor: string;
  zona: string;
  problema: string;
  objetivo: string;
  poblacion: string;
  actividades: string[];
  resultados: string;
  aliados: string[];
  imagen: string;
}

const proyectoEjemplo: ProyectoEjemplo = {
  nombre: "Restauraci√≥n de Cuencas Manuripi",
  estado: "En ejecuci√≥n",
  estadoColor: "bg-green-100 text-green-700 border-green-200",
  zona: "Reserva Manuripi, Pando",
  problema: "Degradaci√≥n de fuentes de agua debido a la erosi√≥n y p√©rdida de cobertura boscosa en zonas cr√≠ticas.",
  objetivo: "Recuperar 50 hect√°reas de bosque ribere√±o y garantizar el acceso a agua limpia para 3 comunidades.",
  poblacion: "120 familias de comunidades locales.",
  actividades: [
    "Viveros comunales de especies nativas.",
    "Capacitaci√≥n en sistemas agroforestales.",
    "Monitoreo de calidad de agua."
  ],
  resultados: "30% de aumento en caudal h√≠drico y reforestaci√≥n de zonas cr√≠ticas.",
  aliados: ["WWF Bolivia", "Municipio de Filadelfia", "Comunidades Locales"],
  imagen: "https://images.unsplash.com/photo-1466692476868-aef1dfb1e735?q=80&w=2070&auto=format&fit=crop"
};

const defaultConfig: ConfigVisual = { 
  color: "bg-gray-600", 
  border: "border-gray-200",
  bg_icon: "bg-gray-50",
  text_icon: "text-gray-600",
  img: "/imags/material_programas/default.jpg", 
  icon: TreePine
};
---

<Layout 
  title="Programas y Proyectos" 
  description="Descubre los 9 programas estrat√©gicos de FORAMA y nuestros proyectos de conservaci√≥n, investigaci√≥n y desarrollo sostenible en Pando, Bolivia"
>
  <Navbar client:load transition:persist />

  <main>
    
    <section 
      class="relative h-screen flex items-center justify-center bg-amazon-900 text-white overflow-hidden"
      aria-labelledby="hero-heading"
    >
      <img 
        src="/imags/material_programas/programas_proyectos.jpg" 
        alt="Proyectos de conservaci√≥n en la Amazon√≠a boliviana" 
        class="absolute inset-0 w-full h-full object-cover transform scale-105"
        loading="eager"
        width="1920"
        height="1080"
      />
      <div class="absolute inset-0 bg-gradient-to-b from-black/50 via-black/10 to-black/60 z-0" aria-hidden="true"></div>
      
      <div class="relative z-10 container mx-auto px-4 text-center">
        <span class="inline-flex items-center gap-2 py-1.5 px-5 rounded-full
                    bg-gradient-to-r from-emerald-700/26 via-green-500/14 to-lime-400/14
                    backdrop-blur-md
                    border border-white/12
                    text-white font-semibold uppercase text-[10px]
                    tracking-[0.32em] mb-8
                    shadow-[0_10px_30px_rgba(0,0,0,0.35)]
                    [text-shadow:0_2px_12px_rgba(0,0,0,0.4)]
                    animate-[fadeUp_700ms_ease-out_both]">
          <span class="w-1.5 h-1.5 rounded-full bg-cyan-200/90 shadow-[0_0_14px_rgba(34,211,238,0.75)]" aria-hidden="true"></span>
          Impacto en terreno
        </span>

        <h1 
          id="hero-heading"
          class="relative font-serif text-6xl md:text-8xl lg:text-9xl font-semibold
                    mb-7 tracking-tight leading-[0.9] text-white
                    animate-[heroTitle_900ms_cubic-bezier(.2,.8,.2,1)_both]
                    [text-shadow:0_2px_0_rgba(0,0,0,0.55),0_10px_30px_rgba(0,0,0,0.55)]
                    [-webkit-text-stroke:2px_rgba(0,0,0,0.45)]"
        >
          Programas y Proyectos
        </h1>

        <p class="relative font-serif text-xl md:text-3xl lg:text-4xl font-medium
                    mb-7 tracking-tight leading-tight text-white
                    [text-shadow:0_2px_0_rgba(0,0,0,0.65),0_10px_26px_rgba(0,0,0,0.55)]
                    [-webkit-text-stroke:1px_rgba(0,0,0,0.35)]">
          Estructuramos nuestras acciones
          <br class="hidden md:block" aria-hidden="true"/>
          <span class="italic font-serif font-semibold">
            bajo 9 programas estrat√©gicos para generar cambios reales en la Amazon√≠a.
          </span>
        </p>
      </div>

      <div class="absolute bottom-10 z-20 animate-bounce">
        <ChevronDown size={40} className="text-white/70" aria-hidden="true" />
      </div>
    </section>

    <section 
      id="programas" 
      class="py-24 bg-stone-50 scroll-mt-20"
      aria-labelledby="programas-heading"
    > 
      <div class="container mx-auto px-4 max-w-7xl">
        
        <header class="text-center mb-20">
          <h2 id="programas-heading" class="text-4xl md:text-5xl font-extrabold text-amazon-900 mb-6">
            Programas Estrat√©gicos
          </h2>
          <div class="w-24 h-1.5 bg-earth-500 mx-auto rounded-full mb-6" aria-hidden="true"></div>
          <p class="text-xl text-gray-600 max-w-2xl mx-auto">
            La estructura operativa que gu√≠a cada uno de nuestros pasos en el territorio.
          </p>
        </header>

        {/* ‚úÖ TARJETAS CON ID CORRECTO */}
        {programasDB.length > 0 ? (
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            {programasDB.map((prog: Programa) => {
              const estilo = configVisual[prog.id] || defaultConfig;
              const Icono = estilo.icon;
              const cardId = `programa-${prog.slug}`;

              return (
                <article 
                  id={cardId}
                  class="group relative h-[400px] rounded-[2rem] overflow-hidden cursor-pointer shadow-lg hover:shadow-2xl transition-all duration-500 scroll-mt-32"
                >
                  <a 
                    href={`/programas/${prog.slug}`} 
                    class="block absolute inset-0 z-10"
                    aria-label={`Ver detalles de ${prog.titulo}`}
                  >
                    <span class="sr-only">Ver detalles de {prog.titulo}</span>
                  </a>

                  <img 
                    src={estilo.img} 
                    alt={`${prog.titulo} - ${prog.descripcion}`}
                    class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                    loading="lazy"
                    width="400"
                    height="400"
                  />
                  
                  <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent opacity-80 group-hover:opacity-90 transition-opacity duration-300 pointer-events-none" aria-hidden="true"></div>

                  <div class="absolute inset-0 p-8 flex flex-col justify-end pointer-events-none">
                    <div class={`w-12 h-1.5 ${estilo.color} rounded-full mb-4 transform -translate-x-4 opacity-0 group-hover:translate-x-0 group-hover:opacity-100 transition-all duration-500`} aria-hidden="true"></div>

                    <h3 class="text-2xl md:text-3xl font-bold text-white mb-2 leading-tight drop-shadow-md">
                      {prog.titulo}
                    </h3>
                    
                    <p class="text-gray-300 text-lg font-light leading-snug mb-6 opacity-90 line-clamp-3">
                      {prog.descripcion}
                    </p>
                    
                    <div class="transform translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-500 delay-100 pointer-events-auto">
                      <span class="inline-flex items-center gap-2 text-white font-bold tracking-wide text-sm uppercase border-b-2 border-white/30 pb-1 hover:border-white transition-colors relative z-20">
                        Proyectos <ArrowRight size={16} aria-hidden="true" />
                      </span>
                    </div>
                  </div>
                </article>
              );
            })}
          </div>
        ) : (
          <div class="text-center py-20">
            <p class="text-gray-500 text-lg">Cargando programas...</p>
          </div>
        )}

        <aside class="mt-16 bg-amazon-900 rounded-[2.5rem] p-12 text-center text-white relative overflow-hidden shadow-2xl">
          <div class="absolute top-0 left-0 w-full h-full opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]" aria-hidden="true"></div>
          
          <div class="relative z-10 max-w-2xl mx-auto">
            <h3 class="text-3xl font-bold mb-4">¬øTienes una propuesta innovadora?</h3>
            <p class="text-amazon-200 text-lg mb-8">
              Buscamos constantemente nuevas alianzas para expandir el impacto de estos programas en la regi√≥n.
            </p>
            <div class="flex flex-col items-center gap-2 mb-6 animate-bounce">
              <svg 
                width="32" 
                height="32" 
                class="text-earth-400"
              >
                <path d="M12 5v14"/>        {/* L√≠nea vertical */}
                <path d="m19 12-7 7-7-7"/>  {/* Puntas de flecha */}
              </svg>
              <span class="text-earth-300 text-sm font-semibold uppercase tracking-wider">
                Formulario abajo
              </span>
            </div>
          </div>
        </aside>

      </div>
    </section>
    
    <section 
      id="contacto-info" 
      class="pb-24 bg-stone-50"
      aria-labelledby="form-heading"
    >
      <div class="container mx-auto px-4 max-w-7xl">
        <div class="bg-white rounded-[3rem] shadow-xl border border-gray-100 overflow-hidden">
          <div class="grid lg:grid-cols-12">

            {/* Panel izquierdo - Info */}
            <aside class="lg:col-span-5 bg-amazon-900 text-white p-8 md:p-12 lg:p-14 relative overflow-hidden flex flex-col justify-between">
              {/* Pattern decorativo */}
              <div class="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none" aria-hidden="true">
                <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="white" stroke-width="1"/>
                    </pattern>
                  </defs>
                  <rect width="100%" height="100%" fill="url(#grid)" />
                </svg>
              </div>

              <div class="relative z-10">
                <h3 class="text-2xl md:text-3xl font-bold mb-2">
                  Informaci√≥n de Contacto Proyectos
                </h3>
                <p class="text-amazon-200 mb-8 md:mb-9 text-base md:text-lg">
                  Aqu√≠ nos encuentras siempre.
                </p>

                <div class="space-y-6 md:space-y-7">
                  {/* Ubicaci√≥n */}
                  <div class="flex items-start gap-4 md:gap-5">
                    <div class="w-11 h-11 md:w-12 md:h-12 rounded-full bg-white/10 flex items-center justify-center shrink-0">
                      <MapPin size={24} className="text-earth-400" aria-hidden="true" />
                    </div>
                    <div>
                      <h4 class="font-bold text-lg">Vis√≠tanos</h4>
                      <address class="text-amazon-100 text-sm leading-relaxed mt-1 not-italic">
                        Calle Graciela P√©rez N¬∞ 055,<br/>Barrio Nazaria. Cobija, Pando.
                      </address>
                    </div>
                  </div>

                  {/* Email */}
                  <div class="flex items-start gap-4 md:gap-5">
                    <div class="w-11 h-11 md:w-12 md:h-12 rounded-full bg-white/10 flex items-center justify-center shrink-0">
                      <Mail size={24} className="text-earth-400" aria-hidden="true" />
                    </div>
                    <div>
                      <h4 class="font-bold text-lg">Escr√≠benos</h4>
                      <a 
                        href="mailto:proyectos@forama.org" 
                        class="text-amazon-100 text-sm hover:text-white transition-colors block mt-1"
                      >
                        proyectos@forama.org
                      </a>
                      <span class="text-xs text-amazon-400">Respuesta en 24-48 hrs</span>
                    </div>
                  </div>

                  {/* Horario */}
                  <div class="flex items-start gap-4 md:gap-5">
                    <div class="w-11 h-11 md:w-12 md:h-12 rounded-full bg-white/10 flex items-center justify-center shrink-0">
                      <Clock size={24} className="text-earth-400" aria-hidden="true" />
                    </div>
                    <div>
                      <h4 class="font-bold text-lg">Horario</h4>
                      <p class="text-amazon-100 text-sm mt-1">Lunes a Viernes</p>
                      <time class="text-white font-bold">08:30 - 16:30</time>
                    </div>
                  </div>
                </div>
              </div>

              <blockquote class="relative z-10 mt-10 pt-10 border-t border-white/10">
                <p class="text-sm text-amazon-300 italic">
                  "Protegiendo el coraz√≥n del bosque desde Pando."
                </p>
              </blockquote>
            </aside>

            {/* Panel derecho - Formulario */}
            <div class="lg:col-span-7 p-8 md:p-12 lg:p-14 bg-white">
              <h3 id="form-heading" class="text-2xl md:text-3xl font-bold text-gray-900 mb-2">
                Env√≠anos un mensaje
              </h3>
              <p class="text-gray-500 mb-8 md:mb-9">
                ¬øTienes alguna propuesta innovadora? Llena el formulario.
              </p>

              <form id="project-form" class="space-y-5 md:space-y-6">
  <div class="grid md:grid-cols-2 gap-5 md:gap-6">
    <div class="space-y-2">
      <label for="nombre-proyecto" class="text-sm font-bold text-gray-700 ml-1">
        Nombre Completo
      </label>
      <input
        type="text"
        id="nombre-proyecto"
        name="nombre"
        required
        class="w-full px-4 py-2.5 rounded-xl bg-gray-50 border border-gray-200
               focus:border-amazon-500 focus:bg-white focus:ring-4 focus:ring-amazon-500/10
               outline-none transition-all"
        placeholder="Tu nombre"
        aria-required="true"
      />
    </div>

    <div class="space-y-2">
      <label for="institucion-proyecto" class="text-sm font-bold text-gray-700 ml-1">
        Instituci√≥n
      </label>
      <input
        type="text"
        id="institucion-proyecto"
        name="institucion"
        class="w-full px-4 py-2.5 rounded-xl bg-gray-50 border border-gray-200
               focus:border-amazon-500 focus:bg-white focus:ring-4 focus:ring-amazon-500/10
               outline-none transition-all"
        placeholder="Empresa / ONG (Opcional)"
      />
    </div>
  </div>

  <div class="grid md:grid-cols-2 gap-5 md:gap-6">
    <div class="space-y-2">
      <label for="email-proyecto" class="text-sm font-bold text-gray-700 ml-1">
        Correo Electr√≥nico
      </label>
      <input
        type="email"
        id="email-proyecto"
        name="email"
        required
        class="w-full px-4 py-2.5 rounded-xl bg-gray-50 border border-gray-200
               focus:border-amazon-500 focus:bg-white focus:ring-4 focus:ring-amazon-500/10
               outline-none transition-all"
        placeholder="tucorreo@ejemplo.com"
        aria-required="true"
      />
    </div>

    <div class="space-y-2">
      <label for="asunto-proyecto" class="text-sm font-bold text-gray-700 ml-1">
        Tipo de Propuesta
      </label>
      <div class="relative">
        <select
          id="asunto-proyecto"
          name="asunto"
          required
          class="w-full px-4 py-2.5 rounded-xl bg-gray-50 border border-gray-200
                 focus:border-amazon-500 focus:bg-white focus:ring-4 focus:ring-amazon-500/10
                 outline-none transition-all appearance-none cursor-pointer text-gray-600"
          aria-required="true"
        >
          <option value="" disabled selected>Selecciona un tipo</option>
          <option value="Alianza Estrat√©gica">Alianza Estrat√©gica</option>
          <option value="Propuesta de Proyecto">Propuesta de Proyecto</option>
          <option value="Consultor√≠a T√©cnica">Consultor√≠a T√©cnica</option>
          <option value="Investigaci√≥n Conjunta">Investigaci√≥n Conjunta</option>
          <option value="Financiamiento">Financiamiento</option>
          <option value="Otro">Otro</option>
        </select>
        <ChevronDown size={20} className="absolute right-4 top-3 text-gray-400 pointer-events-none" aria-hidden="true" />
      </div>
    </div>
  </div>

  <div class="space-y-2">
    <label for="mensaje-proyecto" class="text-sm font-bold text-gray-700 ml-1">
      Descripci√≥n de la Propuesta
    </label>
    <textarea
      id="mensaje-proyecto"
      name="mensaje"
      rows="5"
      required
      class="w-full px-4 py-2.5 rounded-xl bg-gray-50 border border-gray-200
             focus:border-amazon-500 focus:bg-white focus:ring-4 focus:ring-amazon-500/10
             outline-none transition-all resize-none"
      placeholder="Describe tu propuesta, objetivos, alcance y c√≥mo podr√≠amos colaborar..."
      aria-required="true"
    ></textarea>
  </div>

  {/* Estado del formulario */}
  <div id="form-status-project" class="hidden"></div>

  <button
    type="submit"
    id="submit-btn-project"
    class="w-full md:w-auto px-7 bg-amazon-600 text-white font-bold py-3.5 rounded-xl shadow-lg hover:bg-amazon-700 hover:-translate-y-1 transition-all flex items-center justify-center gap-2 focus:outline-none focus:ring-4 focus:ring-amazon-500/50 disabled:opacity-50 disabled:cursor-not-allowed"
    aria-label="Enviar propuesta de proyecto"
  >
    <span id="btn-text-project">Enviar Propuesta</span>
    <Send size={20} id="btn-icon-project" aria-hidden="true" />
    <svg 
      id="btn-spinner-project" 
      class="hidden animate-spin" 
      xmlns="http://www.w3.org/2000/svg" 
      width="20" 
      height="20" 
      viewBox="0 0 24 24" 
      fill="none" 
      stroke="currentColor" 
      stroke-width="2" 
      stroke-linecap="round" 
      stroke-linejoin="round"
    >
      <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
    </svg>
  </button>
</form>

<script>
  const formProject = document.getElementById('project-form') as HTMLFormElement;
  const submitBtnProject = document.getElementById('submit-btn-project') as HTMLButtonElement;
  const btnTextProject = document.getElementById('btn-text-project') as HTMLSpanElement;
  const btnIconProject = document.getElementById('btn-icon-project') as unknown as SVGElement;
  const btnSpinnerProject = document.getElementById('btn-spinner-project') as unknown as SVGElement;
  const formStatusProject = document.getElementById('form-status-project') as HTMLDivElement;

  formProject?.addEventListener('submit', async (e) => {
    e.preventDefault();

    submitBtnProject.disabled = true;
    btnTextProject.textContent = 'Enviando...';
    btnIconProject.classList.add('hidden');
    btnSpinnerProject.classList.remove('hidden');

    const formData = new FormData(formProject);
    const data = {
      nombre: formData.get('nombre'),
      institucion: formData.get('institucion') || '',
      email: formData.get('email'),
      asunto: formData.get('asunto'),
      mensaje: formData.get('mensaje'),
      tipo: 'proyecto'
    };

    try {
      const response = await fetch('/api/send-email', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      });

      const result = await response.json();

      if (result.success) {
        formStatusProject.className = 'p-4 bg-green-50 border border-green-200 rounded-xl text-green-700';
        formStatusProject.innerHTML = `
          <div class="flex items-start gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            <div>
              <strong class="block font-bold mb-1">¬°Propuesta enviada correctamente!</strong>
              <p class="text-sm">Nuestro equipo revisar√° tu propuesta y te contactar√° pronto en <strong>${data.email}</strong></p>
            </div>
          </div>
        `;
        formProject.reset();
      } else {
        throw new Error(result.error);
      }
    } catch (error) {
      formStatusProject.className = 'p-4 bg-red-50 border border-red-200 rounded-xl text-red-700';
      formStatusProject.innerHTML = `
        <div class="flex items-start gap-3">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="12"/>
            <line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <div>
            <strong class="block font-bold mb-1">Error al enviar</strong>
            <p class="text-sm">Intenta nuevamente o escr√≠benos a <strong>proyectosforama@gmail.com</strong></p>
          </div>
        </div>
      `;
    } finally {
      submitBtnProject.disabled = false;
      btnTextProject.textContent = 'Enviar Propuesta';
      btnIconProject.classList.remove('hidden');
      btnSpinnerProject.classList.add('hidden');
      formStatusProject.classList.remove('hidden');

      setTimeout(() => formStatusProject.classList.add('hidden'), 8000);
      formStatusProject.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
  });
</script>

            </div>

          </div>
        </div>
      </div>
    </section>
    {/* Secci√≥n de proyectos destacados */}
    {/*<section 
      id="proyectos" 
      class="py-32 bg-white scroll-mt-20"
      aria-labelledby="proyectos-heading"
    > 
      <div class="container mx-auto px-4 max-w-6xl">
        
        <header class="mb-16 flex flex-col md:flex-row md:items-end justify-between gap-6">
          <div>
            <span class="text-amazon-600 font-bold uppercase tracking-widest text-sm">Transparencia y Gesti√≥n</span>
            <h2 id="proyectos-heading" class="text-4xl md:text-5xl font-extrabold text-amazon-900 mt-3">
              Proyectos Destacados
            </h2>
          </div>
          <div class="flex gap-3" role="tablist" aria-label="Filtros de proyectos">
            <button 
              class="px-6 py-2.5 bg-amazon-900 text-white rounded-full text-sm font-bold shadow-lg focus:outline-none focus:ring-2 focus:ring-amazon-600"
              role="tab"
              aria-selected="true"
            >
              En Ejecuci√≥n
            </button>
            <button 
              class="px-6 py-2.5 bg-gray-100 text-gray-600 rounded-full text-sm font-bold hover:bg-gray-200 transition focus:outline-none focus:ring-2 focus:ring-gray-400"
              role="tab"
              aria-selected="false"
            >
              Finalizados
            </button>
          </div>
        </header>

        <article class="bg-white rounded-[2.5rem] border border-gray-100 shadow-2xl overflow-hidden hover:shadow-[0_20px_50px_rgba(0,0,0,0.1)] transition-shadow duration-500">
          <div class="grid lg:grid-cols-12">
            
            <div class="lg:col-span-8 p-10 md:p-14">
              
              <header class="flex flex-wrap items-start justify-between gap-6 mb-8">
                <div>
                  <div class={`inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wide border ${proyectoEjemplo.estadoColor} mb-4`}>
                    <div class="w-2.5 h-2.5 rounded-full bg-current animate-pulse" aria-hidden="true"></div>
                    {proyectoEjemplo.estado}
                  </div>
                  <h3 class="text-3xl md:text-4xl font-bold text-gray-900 leading-tight">
                    {proyectoEjemplo.nombre}
                  </h3>
                </div>
                <div class="flex items-center gap-2 text-gray-500 bg-gray-50 px-5 py-3 rounded-xl border border-gray-100">
                  <MapPin size={20} aria-hidden="true" />
                  <span class="text-sm font-bold">{proyectoEjemplo.zona}</span>
                </div>
              </header>

              <hr class="border-gray-100 my-10" aria-hidden="true" />

              <div class="grid md:grid-cols-2 gap-12">
                <div class="space-y-8">
                  <section>
                    <h4 class="flex items-center gap-2.5 font-bold text-amazon-900 mb-3 text-lg">
                      <FileText size={20} className="text-earth-500" aria-hidden="true" /> 
                      Problema
                    </h4>
                    <p class="text-gray-600 leading-relaxed">{proyectoEjemplo.problema}</p>
                  </section>
                  
                  <section>
                    <h4 class="flex items-center gap-2.5 font-bold text-amazon-900 mb-3 text-lg">
                      <Target size={20} className="text-earth-500" aria-hidden="true" /> 
                      Objetivo
                    </h4>
                    <p class="text-gray-600 leading-relaxed">{proyectoEjemplo.objetivo}</p>
                  </section>
                </div>

                <div class="space-y-8">
                  <section>
                    <h4 class="flex items-center gap-2.5 font-bold text-amazon-900 mb-3 text-lg">
                      <Users size={20} className="text-earth-500" aria-hidden="true" /> 
                      Poblaci√≥n
                    </h4>
                    <p class="text-gray-600 leading-relaxed">{proyectoEjemplo.poblacion}</p>
                  </section>
                  
                  <section>
                    <h4 class="flex items-center gap-2.5 font-bold text-amazon-900 mb-3 text-lg">
                      <CheckCircle2 size={20} className="text-earth-500" aria-hidden="true" /> 
                      Resultados
                    </h4>
                    <p class="text-gray-600 leading-relaxed">{proyectoEjemplo.resultados}</p>
                  </section>
                </div>
              </div>

              <div class="mt-12 p-8 bg-stone-50 rounded-2xl border border-stone-100">
                <div class="grid md:grid-cols-2 gap-10">
                  <section>
                    <h5 class="text-xs font-bold text-gray-400 uppercase tracking-wider block mb-4">
                      Actividades Clave
                    </h5>
                    <ul class="space-y-3">
                      {proyectoEjemplo.actividades.map((act) => (
                        <li class="flex items-start gap-3 text-gray-700">
                          <span class="mt-2 w-1.5 h-1.5 rounded-full bg-amazon-500 shrink-0" aria-hidden="true"></span>
                          {act}
                        </li>
                      ))}
                    </ul>
                  </section>
                  
                  <section>
                    <h5 class="text-xs font-bold text-gray-400 uppercase tracking-wider block mb-4">
                      Aliados Estrat√©gicos
                    </h5>
                    <div class="flex flex-wrap gap-2">
                      {proyectoEjemplo.aliados.map((aliado) => (
                        <span 
                          class="px-4 py-1.5 bg-white border border-gray-200 rounded-lg text-sm font-semibold text-gray-600 shadow-sm"
                        >
                          {aliado}
                        </span>
                      ))}
                    </div>
                  </section>
                </div>
              </div>

            </div>

            <aside class="lg:col-span-4 bg-gray-100 relative min-h-[400px] lg:min-h-full group">
              <img 
                src={proyectoEjemplo.imagen}
                alt="Paisaje del proyecto de Restauraci√≥n de Cuencas Manuripi" 
                class="absolute inset-0 w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110"
                loading="lazy"
                width="600"
                height="800"
              />
              <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent opacity-60 group-hover:opacity-80 transition-opacity" aria-hidden="true"></div>
              
              <div class="absolute bottom-10 left-8 right-8 text-center">
                <button 
                  class="w-full py-4 bg-white/20 backdrop-blur-xl border border-white/30 text-white rounded-2xl font-bold hover:bg-white hover:text-amazon-900 transition-all flex items-center justify-center gap-3 shadow-2xl focus:outline-none focus:ring-2 focus:ring-white"
                  aria-label="Ver galer√≠a de im√°genes del proyecto"
                >
                  Ver Galer√≠a
                  <ChevronRight size={20} aria-hidden="true" />
                </button>
              </div>
            </aside>

          </div>
        </article>
        
        <footer class="mt-16 text-center">
          <p class="text-gray-400 font-medium">Mostrando 1 de 8 proyectos activos.</p>
        </footer>

      </div>
    </section>*/}
  </main>
</Layout>

<style>
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>

{/* ‚úÖ SCRIPT MEJORADO - Scroll autom√°tico con highlight */}
<script>
  // Ejecutar cuando la p√°gina cargue completamente
  document.addEventListener('DOMContentLoaded', () => {
    const hash = window.location.hash;
    
    if (hash && hash.startsWith('#programa-')) {
      console.log('üéØ Hash detectado:', hash);
      
      // Esperar un poco para asegurar que todo carg√≥
      setTimeout(() => {
        const targetCard = document.querySelector(hash);
        
        if (targetCard) {
          console.log('‚úÖ Tarjeta encontrada');
          
          // Scroll suave a la tarjeta
          targetCard.scrollIntoView({ 
            behavior: 'smooth', 
            block: 'center'
          });
          
          // A√±adir clases de highlight
          targetCard.classList.add('ring-4', 'ring-blue-500', 'ring-offset-4');
          
          // Quitar highlight despu√©s de 2.5 segundos
          setTimeout(() => {
            targetCard.classList.remove('ring-4', 'ring-blue-500', 'ring-offset-4');
          }, 2500);
        } else {
          console.warn('‚ùå Tarjeta no encontrada:', hash);
        }
      }, 500);
    }
  });
</script>